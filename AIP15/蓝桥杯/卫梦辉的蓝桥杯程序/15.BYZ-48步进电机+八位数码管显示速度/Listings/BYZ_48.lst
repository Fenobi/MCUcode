C51 COMPILER V9.59.0.0   BYZ_48                                                            12/19/2022 22:48:43 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE BYZ_48
OBJECT MODULE PLACED IN .\Objects\BYZ_48.obj
COMPILER INVOKED BY: D:\MDK5\C51\BIN\C51.EXE BYZ_48.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\BYZ_4
                    -8.lst) TABS(2) OBJECT(.\Objects\BYZ_48.obj)

line level    source

   1          #include "BYZ_48.h"//BYZ-48步进电机函数头文件
   2          #include "delay.h"//延时函数头文件
   3          
   4          //控制驱动BYZ-48步进电机的四个GPIO
   5          sbit STEPA=P0^0;
   6          sbit STEPB=P0^1;
   7          sbit STEPC=P0^2;
   8          sbit STEPD=P0^3;
   9          
  10          //精度5.625/64度，一圈 4096 个换相
  11          
  12          void BYZ_48_MOTOR1(u8 speed,bit FX)//控制步进电机旋转
  13          {
  14   1        char i;
  15   1        if(FX==1)//顺时针旋转
  16   1        {
  17   2          for(i=0;i<8;i++)
  18   2          {
  19   3            switch(i)
  20   3            {
  21   4              case 0:STEPD=0;STEPC=0;STEPB=0;STEPA=1;break;
  22   4              case 1:STEPD=0;STEPC=0;STEPB=1;STEPA=1;break;
  23   4              case 2:STEPD=0;STEPC=0;STEPB=1;STEPA=0;break;
  24   4              case 3:STEPD=0;STEPC=1;STEPB=1;STEPA=0;break;
  25   4              case 4:STEPD=0;STEPC=1;STEPB=0;STEPA=0;break;
  26   4              case 5:STEPD=1;STEPC=1;STEPB=0;STEPA=0;break;
  27   4              case 6:STEPD=1;STEPC=0;STEPB=0;STEPA=0;break;
  28   4              case 7:STEPD=1;STEPC=0;STEPB=0;STEPA=1;break;     
  29   4            }
  30   3            Delay_ms(speed);
  31   3          }
  32   2        }
  33   1        else if(FX==0)//逆时针旋转
  34   1        {
  35   2          for(i=7;i>=0;i--)
  36   2          {
  37   3            switch(i)
  38   3            {
  39   4              case 0:STEPD=0;STEPC=0;STEPB=0;STEPA=1;break;
  40   4              case 1:STEPD=0;STEPC=0;STEPB=1;STEPA=1;break;
  41   4              case 2:STEPD=0;STEPC=0;STEPB=1;STEPA=0;break;
  42   4              case 3:STEPD=0;STEPC=1;STEPB=1;STEPA=0;break;
  43   4              case 4:STEPD=0;STEPC=1;STEPB=0;STEPA=0;break;
  44   4              case 5:STEPD=1;STEPC=1;STEPB=0;STEPA=0;break;
  45   4              case 6:STEPD=1;STEPC=0;STEPB=0;STEPA=0;break;
  46   4              case 7:STEPD=1;STEPC=0;STEPB=0;STEPA=1;break;     
  47   4            }
  48   3            Delay_ms(speed);
  49   3          }   
  50   2        }
  51   1      }
  52          
  53          
  54          void BYZ_48_MOTOR2(float Angle,bit FX)//控制步进电机以最快速度旋转特定角度
C51 COMPILER V9.59.0.0   BYZ_48                                                            12/19/2022 22:48:43 PAGE 2   

  55          {
  56   1        char i;
  57   1        int MOTOR_count;
  58   1        
  59   1        MOTOR_count=Angle/0.703; //5.625/64*8=0.703, 计算换向次数
  60   1        
  61   1        if(FX==1)//顺时针旋转
  62   1        {
  63   2          while(MOTOR_count>0)
  64   2          {
  65   3            for(i=0;i<8;i++)
  66   3            {
  67   4              switch(i)
  68   4              {
  69   5                case 0:STEPD=0;STEPC=0;STEPB=0;STEPA=1;break;
  70   5                case 1:STEPD=0;STEPC=0;STEPB=1;STEPA=1;break;
  71   5                case 2:STEPD=0;STEPC=0;STEPB=1;STEPA=0;break;
  72   5                case 3:STEPD=0;STEPC=1;STEPB=1;STEPA=0;break;
  73   5                case 4:STEPD=0;STEPC=1;STEPB=0;STEPA=0;break;
  74   5                case 5:STEPD=1;STEPC=1;STEPB=0;STEPA=0;break;
  75   5                case 6:STEPD=1;STEPC=0;STEPB=0;STEPA=0;break;
  76   5                case 7:STEPD=1;STEPC=0;STEPB=0;STEPA=1;break;     
  77   5              }
  78   4              Delay_ms(1);
  79   4            }
  80   3            MOTOR_count--;
  81   3          }
  82   2        }
  83   1        else if(FX==0)//逆时针旋转
  84   1        {
  85   2          while(MOTOR_count>0)
  86   2          {
  87   3            for(i=7;i>=0;i--)
  88   3            {
  89   4              switch(i)
  90   4              {
  91   5                case 0:STEPD=0;STEPC=0;STEPB=0;STEPA=1;break;
  92   5                case 1:STEPD=0;STEPC=0;STEPB=1;STEPA=1;break;
  93   5                case 2:STEPD=0;STEPC=0;STEPB=1;STEPA=0;break;
  94   5                case 3:STEPD=0;STEPC=1;STEPB=1;STEPA=0;break;
  95   5                case 4:STEPD=0;STEPC=1;STEPB=0;STEPA=0;break;
  96   5                case 5:STEPD=1;STEPC=1;STEPB=0;STEPA=0;break;
  97   5                case 6:STEPD=1;STEPC=0;STEPB=0;STEPA=0;break;
  98   5                case 7:STEPD=1;STEPC=0;STEPB=0;STEPA=1;break;     
  99   5              }
 100   4              Delay_ms(1);
 101   4            }
 102   3            MOTOR_count--;      
 103   3          }     
 104   2        }
 105   1      }
 106          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    594    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       5
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----       2
C51 COMPILER V9.59.0.0   BYZ_48                                                            12/19/2022 22:48:43 PAGE 3   

END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
