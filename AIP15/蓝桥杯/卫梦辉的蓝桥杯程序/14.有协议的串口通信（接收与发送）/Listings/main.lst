C51 COMPILER V9.59.0.0   MAIN                                                              12/19/2022 21:10:26 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\MDK5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\main.ls
                    -t) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <STC15F2K60S2.h>
   2          #include <stdio.h>//包含printf();函数头文件
   3          #include <string.h>//包含strcmp(,);函数头文件
   4          #include "delay.h"//延时函数头文件
   5          #include "usart.h"//串口通信函数头文件
   6          
   7          
   8          //strcmp(str1,str2);//比较两个字符串是否相同，相同则返回0
   9          
  10          
  11          //串口接收协议说明：把接收的字符串与规定的命令1和命令2字符串做比较，如果相同则进行对应操作
  12          
  13          unsigned char order1[8]="ST\r\n";   //命令1：查询数据指令:”ST\r\n"
  14          unsigned char order2[8]="PARA\r\n"; //命令2：查询参数指令:"PARA\r\n"
  15          char i,Rdata1=1,Rdata2=1;
  16          
  17          void main()
  18          {
  19   1        Init_Uart();//串口初始化  
  20   1        printf("--WMH--");
  21   1        while(1)
  22   1        {
  23   2          
  24   2          if(Rdata_flag==1)//判断字符串是否接收完成
  25   2          {
  26   3            Rdata_flag=0;//清除字符串接收标志
  27   3            
  28   3            Rdata1=strcmp(order1,R_data);  //命令1比较的返回值 
  29   3            Rdata2=strcmp(order2,R_data);  //命令1比较的返回值 
  30   3            
  31   3            if(Rdata1==0)//判断是否接收命令1
  32   3            {
  33   4              printf("ST ST ST\r\n");
  34   4            }
  35   3            else if(Rdata2==0)//判断是否接收命令2
  36   3            {
  37   4              printf("PARA PARA PARA\r\n");
  38   4            }
  39   3            else//接收命令错误
  40   3            {
  41   4              printf("ERROR...\r\n");
  42   4            }
  43   3            
  44   3            for(i=0;i<8;i++)//清空接收数组，为下次接收数据做准备
  45   3            {
  46   4              R_data[i]='\0';
  47   4            }   
  48   3          }
  49   2      
  50   2        }
  51   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
C51 COMPILER V9.59.0.0   MAIN                                                              12/19/2022 21:10:26 PAGE 2   

   CODE SIZE        =    124    ----
   CONSTANT SIZE    =     47    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     19    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
